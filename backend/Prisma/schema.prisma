generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id         String    @id @default(uuid())
  email      String    @unique
  name       String?
  password   String
  role       Role      @default(FREELANCER)
  createdAt  DateTime  @default(now())
  // relations
  invoicesAsClient     Invoice[] @relation("clientInvoices")
  invoicesAsFreelancer Invoice[] @relation("freelancerInvoices")
  linksFrom            ValueLink[] @relation("linksFrom")
  linksTo              ValueLink[] @relation("linksTo")
}

model Invoice {
  id           String           @id @default(uuid())
  title        String
  amount       Float
  status       InvoiceStatus @default(DRAFT)
  clientId     String?
  freelancerId String?
  createdAt    DateTime      @default(now())

  // relations
  client     User? @relation("clientInvoices", fields: [clientId], references: [id])
  freelancer User? @relation("freelancerInvoices", fields: [freelancerId], references: [id])
}

model ValueLink {
  id         String     @id @default(uuid())
  fromUserId String
  toUserId   String
  projectId  Int?
  valueScore Int      @default(0)
  createdAt  DateTime @default(now())

  // relations
  from User @relation("linksFrom", fields: [fromUserId], references: [id])
  to   User @relation("linksTo", fields: [toUserId], references: [id])
}

enum Role {
  CLIENT
  FREELANCER
}

enum InvoiceStatus {
  DRAFT
  SENT
  PAID
}
